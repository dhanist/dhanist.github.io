Title: proses migrasi postfix email server
Date: 2014-10-11 11:56
Author: Dhani Setiawan
Category: Debian
Tags: Postfix, Debian, Linux
Slug: proses-migrasi-postfix
Status: published
Comments: yes


**[Share] proses migrasi postfix email server**

Well, mungkin saja ada Linux sysadmin yang baca :-)  
Belakangan ini sibuk pindahan postfix email server dari Debian 6
(squeeze) yang berjalan di lingkungan virtualisasi Xen ke dedicated
hardware server dan di server yang baru OS nya Debian 7 (Wheezy).

Ada beberapa hal yang mungkin baik buat di share karena email server di
lingkungan Linux lumayan complicated buatnya.  
Software yang dipakai:  
- Postfix (mta)  
- Dovecot (lda)  
- Amavisd-new (content filter)  
- Spamassassin (anti spam)  
- Opendkim (dkim signing)  
- spf-perl (sender policy framework)  
- MySQL (database backend)

Diawal, saya coba upgrade server yang sudah berjalan dengan copy disk
image ke server baru dan upgrade ke Debian 7 tapi hasilnya malah rusak
sana sini. Akhirnya, fresh install Debian 7 di server baru.  
Gagal upgrade karena versi software package di squeeze dan wheezy
berbeda dan konfigurasi untuk masing-masing software berbeda tiap versi.
Paling parah adalah Dovecot yang begitu diupgrade malah tidak jalan sama
sekali karena beda struktur file konfigurasi. Sedangkan Postfix, syntax
config di [main.cf](http://main.cf) jadi error di versi yang baru.

Setelah dibuat dari awal lagi dan server bisa jalan, masalah lain muncul
lagi, email yang dikirim ke gmail semuanya dianggap spam oleh gmail.
Sedangkan mail service yang lain seperti yahoo mail, hotmail dan aol ok
saja, hanya gmail yang masalah.

Setelah mengikuti panduan gmail tentang spam, ternyata gmail mengabaikan
dkim signature dibawah 1024 bit. Signature dkim dibawah 1024 bit
dianggap sepert tidak ditandatangani oleh server google. Akibatnya,
setup signature opendkim dengan 2048 bit.  
Setelah ini, email masih dianggap spam oleh gmail. Agak frustasi karena
ketika di tes dengan web tool di
<http://www.brandonchecketts.com/emailtest.php> semuanya ok, dkim dan
spf pass.

setelah googling tentang masalah ini, ada beberapa yang mengalami
masalah yang sama dan menurut mereka, ini cuma masalah waktu sebelum
server gmail mengenali server yang baru. Ya, karena ip address server
yang baru berbeda dengan yang lama.

Akhirnya menunggu saja. Dan setelah beberapa hari, mungkin seminggu,
email yang ke gmail bisa masuk inbox dan bukan lagi dianggap spam.  
Jadi, kalau baru pindah server email dan beda ip address kemudian email
masuk spam gmail, jangan panik. Tunggu saja, everything is gonna be
alright :)

That's it.  
[\#debian](https://plus.google.com/s/%23debian)
[\#postfix](https://plus.google.com/s/%23postfix)
[\#linux](https://plus.google.com/s/%23linux)
[\#gmail](https://plus.google.com/s/%23gmail)
